import numpy as np
import matplotlib.pyplot as plt
import scipy.stats as stats


# ĞœĞ°Ñ‚ĞµĞ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ Ğ¼ĞµÑ‚Ğ¾Ğ´ Ğ½Ğ°Ñ…Ğ¾Ğ¶Ğ´ĞµĞ½Ğ¸Ñ ĞºĞ¾ÑÑ„Ñ„Ğ¸Ñ†Ğ¸ĞµĞ½Ñ‚Ğ¾Ğ² Ğ»Ğ¸Ğ½ĞµĞ¹Ğ½Ğ¾Ğ¹ Ñ€ĞµĞ³Ñ€ĞµÑÑĞ¸Ğ¸ y = b_0 + b_1 * x
def LinRegression_math(X_ds, Y_ds, intercept=True, rnd=3):
    if intercept:
        # ğ‘1 = ( ğ‘›*âˆ‘(ğ‘–=1; ğ‘›) ğ‘¥_ğ‘– ğ‘¦_ğ‘– âˆ’ (âˆ‘(ğ‘–=1; ğ‘›) ğ‘¥_ğ‘–) * (âˆ‘ (ğ‘–=1; ğ‘›) ğ‘¦_ğ‘–) ) /
        # ( ğ‘›âˆ‘_(ğ‘–=1; ğ‘›) ğ‘¥_ğ‘–^2 âˆ’ (âˆ‘(ğ‘–=1; ğ‘›) ğ‘¥_ğ‘–)^2 )
        # b0 = ğ‘¦_mean âˆ’ b1 * ğ‘¥_mean
        b1 = (np.mean(X_ds * Y_ds) - np.mean(X_ds) * np.mean(Y_ds)) / \
              (np.mean(X_ds ** 2) - np.mean(X_ds) ** 2)
        b0 = np.mean(Y_ds) - b1 * np.mean(X_ds)
    else:
        # ğ‘1 = âˆ‘(ğ‘–=1; ğ‘›) ğ‘¥_ğ‘– ğ‘¦_ğ‘– / âˆ‘_(ğ‘–=1; ğ‘›) ğ‘¥_ğ‘–^2
        # b0 = 0
        b1 = np.sum(X_ds * Y_ds) / np.sum(X_ds ** 2)
        b0 = 0
    return round(b0, rnd), round(b1, rnd)


# ĞœĞ°Ñ‚Ñ€Ğ¸Ñ‡Ğ½Ñ‹Ğ¹ Ğ¼ĞµÑ‚Ğ¾Ğ´ Ğ½Ğ°Ñ…Ğ¾Ğ¶Ğ´ĞµĞ½Ğ¸Ñ ĞºĞ¾ÑÑ„Ñ„Ğ¸Ñ†Ğ¸ĞµĞ½Ñ‚Ğ¾Ğ² Ğ»Ğ¸Ğ½ĞµĞ¹Ğ½Ğ¾Ğ¹ Ñ€ĞµĞ³Ñ€ĞµÑÑĞ¸Ğ¸:
# y = b_0 + b_1 * x => Y = X * B (Ğ² Ğ¼Ğ°Ñ‚Ñ€Ğ¸Ñ‡Ğ½Ğ¾Ğ¼ Ğ²Ğ¸Ğ´Ğµ, Ğ³Ğ´Ğµ Y, X Ğ¸ B - Ğ¼Ğ°Ñ‚Ñ€Ğ¸Ñ‡Ğ½Ğ¾Ğµ Ğ¾Ñ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…)
# (ğ‘¦_1 @ ğ‘¦_2 @ ğ‘¦_3) = (1 & ğ‘¥_1 @ 1 & ğ‘¥_2 @ 1 & ğ‘¥_3) * (ğ›½_0 @ ğ›½_1)
# ĞÑ‚ĞºÑƒĞ´Ğ°:
# ğµ = (ğ‘‹.ğ‘‡ âˆ— ğ‘‹)^(âˆ’1) âˆ— ğ‘‹.ğ‘‡ âˆ— ğ‘Œ
#
# b0 = ğ‘¦_mean âˆ’ b1 * ğ‘¥_mean
def LinRegression_matrix(x_ds, y_ds, rnd=3):
    X = x_ds.reshape(-1, 1)
    X = np.hstack([np.ones(x_ds.shape + (1,)), X])
    Y = y_ds.reshape(-1, 1)
    B = np.dot(np.linalg.inv(np.dot(X.T, X)), np.dot(X.T, Y))
    b0, b1 = B[:, 0]
    return round(b0, rnd), round(b1, rnd)


# ĞœĞµÑ‚Ğ¾Ğ´ Ğ³Ñ€Ğ°Ğ´Ğ¸ĞµĞ½Ñ‚Ğ½Ğ¾Ğ³Ğ¾ ÑĞ¿ÑƒÑĞºĞ°:
# ĞÑ‡ĞµÑ€ĞµĞ´Ğ½Ğ¾Ğµ Ğ¿Ñ€Ğ¸Ğ±Ğ»Ğ¸Ğ¶ĞµĞ½Ğ¸Ğµ Ñ€Ğ°ÑÑÑ‡Ğ¸Ñ‚Ñ‹Ğ²Ğ°ĞµÑ‚ÑÑ Ğ¿Ğ¾ Ñ„Ğ¾Ñ€Ğ¼ÑƒĞ»Ğµ:
# 1) Ğ‘ĞµĞ· intercept - B_n+1 = B_n - l_rate * (2/n) * âˆ‘(ğ‘–=1; ğ‘›)((B_n*X_i - Y_i) * X_i)
def LinRegression_GD(X, Y, intercept=False, rnd=3,
                     n_epochs=None, l_rate=1e-6):

    def mae_(B, Y, X, N):
        b0, b1 = B
        mae_ret = np.sum(b1 * X - Y)**2 / N if not intercept else \
                  np.sum((b0 + b1 * X) - Y)**2 / N
        return mae_ret

    N = X.size
    Y_mean      = np.mean(Y)
    Y_min       = np.min(Y)
    n_epochs    = 100 if n_epochs is None else n_epochs
    batch       = n_epochs / 20
    l_rate      = 1e-6 if l_rate is None else l_rate
    DOC_stop    = 1e-6                          # Ğ¸Ñ‰ĞµĞ¼ Ğ¿Ğ¾ĞºĞ° ÑÑ‚ĞµĞ¿ĞµĞ½ÑŒ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ mae_ Ğ½Ğµ ÑÑ‚Ğ°Ğ½ĞµÑ‚ Ğ¼ĞµĞ½ÑŒÑˆĞµ 0,001%
    B0          = 0 if not intercept else Y_min
    B1          = np.mean((Y-B0)/X)             # Ğ·Ğ°Ğ´Ğ°ĞµĞ¼ Ğ½Ğ°Ñ‡Ğ°Ğ»ÑŒĞ½Ğ¾Ğµ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ
    for i in range(n_epochs):
        grad_B1 = (2 / N) * np.sum((B0 + B1 * X - Y) * X)
        grad_B0 = 0 if not intercept else (2 / N) * np.sum((B0 + B1 * X - Y))
        B1 -= l_rate * grad_B1
        B0 -= l_rate * grad_B0
        mae_curr = mae_((B0, B1), Y, X, N)
        DOC_c = np.sqrt(mae_curr) / Y_mean
        if i % batch == 0 or DOC_c < DOC_stop:
            print(f'Ğ˜Ñ‚ĞµÑ€Ğ°Ñ†Ğ¸Ñ {i}: (B0, B1) = {B0, B1}, acc = {mae_curr}, Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğµ = {DOC_c * 100}%')
            if DOC_c < DOC_stop:
                break

    return round(B0, rnd), round(B1, rnd)


# Ğ’Ñ‹Ğ²Ğ¾Ğ´ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ° Ñ€Ğ°ÑÑ‡ĞµÑ‚Ğ° Ğ»Ğ¸Ğ½ĞµĞ¹Ğ½Ğ¾Ğ¹ Ñ€ĞµĞ³Ñ€ĞµÑÑĞ¸Ğ¸
def print_result(X_ds, Y_ds, b0, b1, tt=None, txt_method='Ğ¼Ğ°Ñ‚ĞµĞ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ Ğ¼ĞµÑ‚Ğ¾Ğ´'):
    print('***')
    print(f'Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ñ Ğ»Ğ¸Ğ½ĞµĞ¹Ğ½Ğ¾Ğ¹ Ñ€ĞµĞ³Ñ€ĞµÑÑĞ¸Ğ¸ Ğ´Ğ»Ñ {f"{tt}" if tt else f"Ğ½Ğ°Ğ±Ğ¾Ñ€Ğ° Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…"}:\n'
          f'X = {X_ds}\n'
          f'Y = {Y_ds}\n'
          f'Y = {b0} + {b1} * X - Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½ {txt_method}')


# ĞŸĞ¾ĞºĞ°Ğ·Ğ°Ñ‚ÑŒ Ğ³Ñ€Ğ°Ñ„Ğ¸Ñ‡ĞµÑĞºÑƒÑ Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚ÑŒ Ğ¼ĞµĞ¶Ğ´Ñƒ Ğ½Ğ°Ğ±Ğ¾Ñ€Ğ°Ğ¼Ğ¸ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ¸ Ñ€Ğ°ÑÑÑ‡Ğ¸Ñ‚Ğ°Ğ½Ğ½ÑƒÑ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ñ Ğ»Ğ¸Ğ½. Ñ€ĞµĞ³Ñ€ĞµÑÑĞ¸Ğ¸
def show_XY(X_ds, Y_ds, y_func=None,
            not_label=None, not_legend=None,
            tt=None, splot=None, show_plots=True):
    tt = 'ĞĞ°Ğ±Ğ¾Ñ€ Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ñ‹Ñ… Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… y = F(x)' if tt is None else tt
    if splot is None:
        splot = plt
        splot.title(tt)
        splot.xlabel('Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ X')
        splot.ylabel('Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Y')
    else:
        splot.set_title(tt)
        if not not_label:
            splot.set_xlabel('Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ X')
            splot.set_ylabel('Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Y')

    splot.scatter(X_ds, Y_ds, label='Ğ”Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ½Ğ°Ğ±Ğ¾Ñ€Ğ¾Ğ² X, Y')
    if y_func:
        y_f = y_func.replace('x', 'X_ds')
        splot.plot(X_ds, eval(y_f), color='r', label=f'Ğ›Ğ¸Ğ½.Ñ€ĞµĞ³Ñ€ĞµÑÑĞ¸Ñ y = {y_func}')
    if not not_legend: splot.legend()
    if show_plots:
        plt.show()


"""
Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ğ¹ ĞŸÑ€Ğ°ĞºÑ‚Ğ¸ĞºĞ¸ Ğº Ğ£Ñ€Ğ¾ĞºÑƒ-9
"""

# Ğ—Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ-1.
# Ğ”Ğ°Ğ½Ñ‹ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ñ Ğ²ĞµĞ»Ğ¸Ñ‡Ğ¸Ğ½Ñ‹ Ğ·Ğ°Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ½Ğ¾Ğ¹ Ğ¿Ğ»Ğ°Ñ‚Ñ‹ Ğ·Ğ°ĞµĞ¼Ñ‰Ğ¸ĞºĞ¾Ğ² Ğ±Ğ°Ğ½ĞºĞ° (zp) Ğ¸
# Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ñ Ğ¸Ñ… Ğ¿Ğ¾Ğ²ĞµĞ´ĞµĞ½Ñ‡ĞµÑĞºĞ¾Ğ³Ğ¾ ĞºÑ€ĞµĞ´Ğ¸Ñ‚Ğ½Ğ¾Ğ³Ğ¾ ÑĞºĞ¾Ñ€Ğ¸Ğ½Ğ³Ğ° (ks):
# zp = [35, 45, 190, 200, 40, 70, 54, 150, 120, 110],
# ks = [401, 574, 874, 919, 459, 739, 653, 902, 746, 832].
# Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒÑ Ğ¼Ğ°Ñ‚ĞµĞ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸, Ğ¿Ğ¾ÑÑ‡Ğ¸Ñ‚Ğ°Ñ‚ÑŒ ĞºĞ¾ÑÑ„Ñ„Ğ¸Ñ†Ğ¸ĞµĞ½Ñ‚Ñ‹ Ğ»Ğ¸Ğ½ĞµĞ¹Ğ½Ğ¾Ğ¹ Ñ€ĞµĞ³Ñ€ĞµÑÑĞ¸Ğ¸,
# Ğ¿Ñ€Ğ¸Ğ½ÑĞ² Ğ·Ğ° X Ğ·Ğ°Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ½ÑƒÑ Ğ¿Ğ»Ğ°Ñ‚Ñƒ (Ñ‚Ğ¾ ĞµÑÑ‚ÑŒ, zp - Ğ¿Ñ€Ğ¸Ğ·Ğ½Ğ°Ğº),
# Ğ° Ğ·Ğ° y - Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ñ ÑĞºĞ¾Ñ€Ğ¸Ğ½Ğ³Ğ¾Ğ²Ğ¾Ğ³Ğ¾ Ğ±Ğ°Ğ»Ğ»Ğ° (Ñ‚Ğ¾ ĞµÑÑ‚ÑŒ, ks - Ñ†ĞµĞ»ĞµĞ²Ğ°Ñ Ğ¿ĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ğ°Ñ).
# ĞŸÑ€Ğ¾Ğ¸Ğ·Ğ²ĞµÑÑ‚Ğ¸ Ñ€Ğ°ÑÑ‡ĞµÑ‚ ĞºĞ°Ğº Ñ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸ĞµĞ¼ intercept, Ñ‚Ğ°Ğº Ğ¸ Ğ±ĞµĞ·.

# ĞĞ°Ğ±Ğ¾Ñ€ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… ĞšÑ€ĞµĞ´Ğ¸Ñ‚Ğ½Ñ‹Ğ¹ ÑĞºĞ¾Ñ€Ğ¸Ğ½Ğ³:
tit = 'ĞšÑ€ĞµĞ´Ğ¸Ñ‚Ğ½Ñ‹Ğ¹ ÑĞºĞ¾Ñ€Ğ¸Ğ½Ğ³'
zp = np.array([35,   45, 190, 200, 40,   70,  54, 150, 120, 110])
ks = np.array([401, 574, 874, 919, 459, 739, 653, 902, 746, 832])

# Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚:
print('\n--------------------------------------------')
print(f'Ğ—Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ-1. {tit}:')
print('X - Ğ—Ğ°Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ½Ğ°Ñ Ğ¿Ğ»Ğ°Ñ‚Ğ°')
print('Y - CĞºĞ¾Ñ€Ğ¸Ğ½Ğ³Ğ¾Ğ²Ñ‹Ğ¹ Ğ±Ğ°Ğ»Ğ»')

print('\n1) Ğ›Ğ¸Ğ½ĞµĞ¹Ğ½Ğ°Ñ Ñ€ĞµĞ³Ñ€ĞµÑÑĞ¸Ñ Ñ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸ĞµĞ¼ intercept:')
b_0, b_1    = LinRegression_math(zp, ks)                 # Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼ Ğ¼Ğ°Ñ‚ĞµĞ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºÑƒÑ Ñ„Ğ¾Ñ€Ğ¼ÑƒĞ»Ñƒ
b_0m, b_1m  = LinRegression_matrix(zp, ks)               # Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼ Ğ¼Ğ°Ñ‚Ñ€Ğ¸Ñ‡Ğ½Ñ‹Ğµ Ğ²Ñ‹Ñ‡Ğ¸ÑĞ»ĞµĞ½Ğ¸Ñ
print_result(zp, ks, b_0, b_1, tt=tit, txt_method='Ğ¼Ğ°Ñ‚ĞµĞ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ Ğ¼ĞµÑ‚Ğ¾Ğ´')
print_result(zp, ks, b_0m, b_1m, tt=tit, txt_method='Ğ¼Ğ°Ñ‚Ñ€Ğ¸Ñ‡Ğ½Ñ‹Ğ¹ Ğ¼ĞµÑ‚Ğ¾Ğ´')
show_XY(zp, ks, tt=tit, y_func=f'{b_0} + {b_1} * x')

print('\n2) Ğ›Ğ¸Ğ½ĞµĞ¹Ğ½Ğ°Ñ Ñ€ĞµĞ³Ñ€ĞµÑÑĞ¸Ñ Ğ±ĞµĞ· Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ intercept:')
b_0, b_1   = LinRegression_math(zp, ks, intercept=False, rnd=5)     # Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼ Ğ¼Ğ°Ñ‚ĞµĞ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºÑƒÑ Ñ„Ğ¾Ñ€Ğ¼ÑƒĞ»Ñƒ
print_result(zp, ks, b_0, b_1, tt=tit, txt_method='Ğ¼Ğ°Ñ‚ĞµĞ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ Ğ¼ĞµÑ‚Ğ¾Ğ´')
show_XY(zp, ks, tt=tit, y_func=f'{b_0} + {b_1} * x')

R = np.corrcoef(zp, ks) ** 2                                        # ĞºĞ¾ÑÑ„Ñ„Ğ¸Ñ†Ğ¸ĞµĞ½Ñ‚ Ğ´ĞµÑ‚ĞµÑ€Ğ¼Ğ¸Ğ½Ğ°Ñ†Ğ¸Ğ¸
print(f'\nĞšĞ¾ÑÑ„Ñ„Ğ¸Ñ†Ğ¸ĞµĞ½Ñ‚ Ğ´ĞµÑ‚ĞµÑ€Ğ¼Ğ¸Ğ½Ğ°Ñ†Ğ¸Ğ¸ R = {round(R[0,1], 4)}')


# Ğ—Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ-2.
# ĞŸĞ¾ÑÑ‡Ğ¸Ñ‚Ğ°Ñ‚ÑŒ ĞºĞ¾ÑÑ„Ñ„Ğ¸Ñ†Ğ¸ĞµĞ½Ñ‚ Ğ»Ğ¸Ğ½ĞµĞ¹Ğ½Ğ¾Ğ¹ Ñ€ĞµĞ³Ñ€ĞµÑÑĞ¸Ğ¸ Ğ¿Ñ€Ğ¸ Ğ·Ğ°Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ½Ğ¾Ğ¹ Ğ¿Ğ»Ğ°Ñ‚Ğµ (zp),
# Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒÑ Ğ³Ñ€Ğ°Ğ´Ğ¸ĞµĞ½Ñ‚Ğ½Ñ‹Ğ¹ ÑĞ¿ÑƒÑĞº (Ğ±ĞµĞ· intercept)..
print()
print('\n--------------------------------------------')
print(f'Ğ—Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ-2. {tit}:')
print('\nĞ›Ğ¸Ğ½ĞµĞ¹Ğ½Ğ°Ñ Ñ€ĞµĞ³Ñ€ĞµÑÑĞ¸Ñ Ğ±ĞµĞ· Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ intercept:')
b_0, b_1 = LinRegression_GD(zp, ks, intercept=False, rnd=5,
                            n_epochs=10000, l_rate=1e-5)         # Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼ Ğ¼ĞµÑ‚Ğ¾Ğ´ Ğ³Ñ€Ğ°Ğ´Ğ¸ĞµĞ½Ñ‚Ğ½Ğ¾Ğ³Ğ¾ ÑĞ¿ÑƒÑĞºĞ°
print_result(zp, ks, b_0, b_1, tt=tit, txt_method='Ğ¼ĞµÑ‚Ğ¾Ğ´ Ğ³Ñ€Ğ°Ğ´Ğ¸ĞµĞ½Ñ‚Ğ½Ğ¾Ğ³Ğ¾ ÑĞ¿ÑƒÑĞºĞ°')


# Ğ—Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ-3.
# ĞŸÑ€Ğ¾Ğ¸Ğ·Ğ²ĞµÑÑ‚Ğ¸ Ğ²Ñ‹Ñ‡Ğ¸ÑĞ»ĞµĞ½Ğ¸Ñ ĞºĞ°Ğº Ğ² Ğ¿ÑƒĞ½ĞºÑ‚Ğµ 2, Ğ½Ğ¾ Ñ Ğ²Ñ‹Ñ‡Ğ¸ÑĞ»ĞµĞ½Ğ¸ĞµĞ¼ intercept.
# Ğ£Ñ‡ĞµÑÑ‚ÑŒ, Ñ‡Ñ‚Ğ¾ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğµ ĞºĞ¾ÑÑ„Ñ„Ğ¸Ñ†Ğ¸ĞµĞ½Ñ‚Ğ¾Ğ² Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ¾ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ÑŒÑÑ Ğ½Ğ° ĞºĞ°Ğ¶Ğ´Ğ¾Ğ¼ ÑˆĞ°Ğ³Ğµ Ğ¾Ğ´Ğ½Ğ¾Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ½Ğ¾
# (Ñ‚Ğ¾ ĞµÑÑ‚ÑŒ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğµ Ğ¾Ğ´Ğ½Ğ¾Ğ³Ğ¾ ĞºĞ¾ÑÑ„Ñ„Ğ¸Ñ†Ğ¸ĞµĞ½Ñ‚Ğ° Ğ½Ğµ Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ¾ Ğ²Ğ»Ğ¸ÑÑ‚ÑŒ Ğ½Ğ° Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğµ Ğ´Ñ€ÑƒĞ³Ğ¾Ğ³Ğ¾ Ğ²Ğ¾ Ğ²Ñ€ĞµĞ¼Ñ Ğ¾Ğ´Ğ½Ğ¾Ğ¹ Ğ¸Ñ‚ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸).
print()
print('\n--------------------------------------------')
print(f'Ğ—Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ-3. {tit}:')
print('\nĞ›Ğ¸Ğ½ĞµĞ¹Ğ½Ğ°Ñ Ñ€ĞµĞ³Ñ€ĞµÑÑĞ¸Ñ c Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸ĞµĞ¼ intercept:')
b_0, b_1 = LinRegression_GD(zp, ks, intercept=True, rnd=3,
                            n_epochs=1000000, l_rate=3e-5)         # Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼ Ğ¼ĞµÑ‚Ğ¾Ğ´ Ğ³Ñ€Ğ°Ğ´Ğ¸ĞµĞ½Ñ‚Ğ½Ğ¾Ğ³Ğ¾ ÑĞ¿ÑƒÑĞºĞ°
print_result(zp, ks, b_0, b_1, tt=tit, txt_method='Ğ¼ĞµÑ‚Ğ¾Ğ´ Ğ³Ñ€Ğ°Ğ´Ğ¸ĞµĞ½Ñ‚Ğ½Ğ¾Ğ³Ğ¾ ÑĞ¿ÑƒÑĞºĞ°')

exit()


"""
Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ğ¹ ÑĞµĞ¼Ğ¸Ğ½Ğ°Ñ€Ğ° Ğº Ğ£Ñ€Ğ¾ĞºÑƒ-9
"""

# Ğ—Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ-1 Ğ¡ĞµĞ¼Ğ¸Ğ½Ğ°Ñ€Ğ°
# ĞŸĞ¾ÑÑ‚Ñ€Ğ¾Ğ¹Ñ‚Ğµ Ğ³Ñ€Ğ°Ñ„Ğ¸ĞºĞ¸ Ğ´Ğ»Ñ Ğ¿Ñ€Ğ¸Ğ²ĞµĞ´ĞµĞ½Ğ½Ñ‹Ñ… Ğ½Ğ°Ğ±Ğ¾Ñ€Ğ¾Ğ² Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…. ĞĞ°Ğ¹Ğ´Ğ¸Ñ‚Ğµ ĞºĞ¾ÑÑ„Ñ„Ğ¸Ñ†Ğ¸ĞµĞ½Ñ‚Ñ‹ Ğ´Ğ»Ñ Ğ»Ğ¸Ğ½Ğ¸Ğ¸
# Ñ€ĞµĞ³Ñ€ĞµÑÑĞ¸Ğ¸ Ğ¸ ĞºĞ¾ÑÑ„Ñ„Ğ¸Ñ†Ğ¸ĞµĞ½Ñ‚Ñ‹ Ğ´ĞµÑ‚ĞµÑ€Ğ¼Ğ¸Ğ½Ğ°Ñ†Ğ¸Ğ¸. Ğ§Ñ‚Ğ¾ Ğ²Ñ‹ Ğ·Ğ°Ğ¼ĞµÑ‡Ğ°ĞµÑ‚Ğµ? ĞĞ°Ğ½ĞµÑĞ¸Ñ‚Ğµ Ğ½Ğ° Ğ³Ñ€Ğ°Ñ„Ğ¸Ğº Ğ¼Ğ¾Ğ´ĞµĞ»ÑŒ
# Ğ»Ğ¸Ğ½ĞµĞ¹Ğ½Ğ¾Ğ¹ Ñ€ĞµĞ³Ñ€ĞµÑÑĞ¸Ğ¸.
# X1= np.array([30,30,40, 40])
# Y1= np.array([37, 47, 50, 60])
# x2= np.array([30,30,40, 40, 20, 20, 50, 50])
# y2= np.array([37, 47, 50, 60, 25, 35, 62, 72])
# X3 = np.array([30,30,40, 40, 20, 20, 50, 50, 10, 10, 60, 60])
# Y3 = np.array([37, 47, 50, 60, 25, 35, 62, 72, 13, 23, 74, 84])


# 1. ĞĞ°Ğ±Ğ¾Ñ€ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… â„–1:
# show_dataset(X1, Y1, tt='ĞĞ°Ğ±Ğ¾Ñ€ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… â„–1')
tit = 'ĞĞ°Ğ±Ğ¾Ñ€ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… â„–1'
X1 = np.array([30, 30, 40, 40])
Y1 = np.array([37, 47, 50, 60])
b_0, b_1 = LinRegression_math(X1, Y1, rnd=3)            # Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼ Ğ¼Ğ°Ñ‚ĞµĞ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºÑƒÑ Ñ„Ğ¾Ñ€Ğ¼ÑƒĞ»Ñƒ
R = np.corrcoef(X1, Y1) ** 2                            # ĞºĞ¾ÑÑ„Ñ„Ğ¸Ñ†Ğ¸ĞµĞ½Ñ‚ Ğ´ĞµÑ‚ĞµÑ€Ğ¼Ğ¸Ğ½Ğ°Ñ†Ğ¸Ğ¸

# Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚:
# print(f'ĞšĞ¾ÑÑ„Ñ„Ğ¸Ñ†Ğ¸ĞµĞ½Ñ‚ Ğ´ĞµÑ‚ĞµÑ€Ğ¼Ğ¸Ğ½Ğ°Ñ†Ğ¸Ğ¸ R:\n{R}')
print_result(X1, Y1, b_0, b_1, tt=tit)                  # Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ñ Ğ»Ğ¸Ğ½ĞµĞ¹Ğ½Ğ¾Ğ¹ Ñ€ĞµĞ³Ñ€ĞµÑÑĞ¸Ğ¸
print(f'ĞšĞ¾ÑÑ„Ñ„Ğ¸Ñ†Ğ¸ĞµĞ½Ñ‚ Ğ´ĞµÑ‚ĞµÑ€Ğ¼Ğ¸Ğ½Ğ°Ñ†Ğ¸Ğ¸ R = {round(R[0, 1], 4)}')
show_XY(X1, Y1, tt=tit, y_func=f'{b_0} + {b_1} * x')    # Ğ³Ñ€Ğ°Ñ„Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ Ğ¾Ñ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ğµ

# 2. ĞĞ°Ğ±Ğ¾Ñ€ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… â„–2:
tit = 'ĞĞ°Ğ±Ğ¾Ñ€ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… â„–2'
x2 = np.array([30,30,40, 40, 20, 20, 50, 50])
y2 = np.array([37, 47, 50, 60, 25, 35, 62, 72])
b_0, b_1 = LinRegression_math(x2, y2)                   # Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼ Ğ¼Ğ°Ñ‚ĞµĞ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºÑƒÑ Ñ„Ğ¾Ñ€Ğ¼ÑƒĞ»Ñƒ
R = np.corrcoef(x2, y2) ** 2                            # ĞºĞ¾ÑÑ„Ñ„Ğ¸Ñ†Ğ¸ĞµĞ½Ñ‚ Ğ´ĞµÑ‚ĞµÑ€Ğ¼Ğ¸Ğ½Ğ°Ñ†Ğ¸Ğ¸

# Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚:
print_result(x2, y2, b_0, b_1, tt=tit)
print(f'ĞšĞ¾ÑÑ„Ñ„Ğ¸Ñ†Ğ¸ĞµĞ½Ñ‚ Ğ´ĞµÑ‚ĞµÑ€Ğ¼Ğ¸Ğ½Ğ°Ñ†Ğ¸Ğ¸ R = {round(R[0, 1], 4)}')
show_XY(x2, y2, tt=tit, y_func=f'{b_0} + {b_1} * x')


# 3. ĞĞ°Ğ±Ğ¾Ñ€ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… â„–3:
tit = 'ĞĞ°Ğ±Ğ¾Ñ€ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… â„–3'
X3 = np.array([30,30,40, 40, 20, 20, 50, 50, 10, 10, 60, 60])
Y3 = np.array([37, 47, 50, 60, 25, 35, 62, 72, 13, 23, 74, 84])
b_0, b_1    = LinRegression_math(X3, Y3)                        # Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼ Ğ¼Ğ°Ñ‚ĞµĞ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºÑƒÑ Ñ„Ğ¾Ñ€Ğ¼ÑƒĞ»Ñƒ
b_0m, b_1m  = LinRegression_matrix(X3, Y3)                      # Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼ Ğ¼Ğ°Ñ‚Ñ€Ğ¸Ñ‡Ğ½Ñ‹Ğµ Ğ²Ñ‹Ñ‡Ğ¸ÑĞ»ĞµĞ½Ğ¸Ñ

R = np.corrcoef(X3, Y3) ** 2                                    # ĞºĞ¾ÑÑ„Ñ„Ğ¸Ñ†Ğ¸ĞµĞ½Ñ‚ Ğ´ĞµÑ‚ĞµÑ€Ğ¼Ğ¸Ğ½Ğ°Ñ†Ğ¸Ğ¸

# Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚:
print_result(X3, Y3, b_0, b_1, tt=tit)
print_result(X3, Y3, b_0m, b_1m, tt=tit, txt_method='Ğ¼Ğ°Ñ‚Ñ€Ğ¸Ñ‡Ğ½Ñ‹Ğ¹ Ğ¼ĞµÑ‚Ğ¾Ğ´')
print(f'ĞšĞ¾ÑÑ„Ñ„Ğ¸Ñ†Ğ¸ĞµĞ½Ñ‚ Ğ´ĞµÑ‚ĞµÑ€Ğ¼Ğ¸Ğ½Ğ°Ñ†Ğ¸Ğ¸ R = {round(R[0, 1], 4)}')
show_XY(X3, Y3, tt=tit, y_func=f'{b_0} + {b_1} * x')


# ---------------------------------------------------------------------------------
# Ğ—Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ-2 Ğ¡ĞµĞ¼Ğ¸Ğ½Ğ°Ñ€Ğ°
# ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ Ğ¿Ñ€Ğ¸Ğ¼ĞµĞ½Ğ¸Ğ¼Ğ¾ÑÑ‚ÑŒ Ğ»Ğ¸Ğ½ĞµĞ¹Ğ½Ğ¾Ğ¹ Ñ€ĞµĞ³Ñ€ĞµÑÑĞ¸Ğ¸ Ğº Ğ½Ğ°Ğ±Ğ¾Ñ€Ğ°Ğ¼ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…:
x = np.array([10, 8, 13, 9, 11, 14, 6, 4, 12, 7, 5])
y1 = np.array([8.04, 6.95, 7.58, 8.81, 8.33, 9.96, 7.24, 4.26, 10.84, 4.82, 5.68 ])
# ... x= np.array([ 10,8, 13, 9,11,14, 6,4,12, 7,5 ])
y2 = np.array([ 9.14, 8.14, 8.74,8.77, 9.26, 8.10, 6.13, 3.10, 9.13, 7.26, 4.74])
# ... x= np.array([ 10,8, 13, 9,11,14, 6,4,12, 7,5 ])
y3 = np.array([7.46,6.77, 12.74, 7.11, 7.81, 8.84, 6.08, 5.39, 8.15, 6.42, 5.73])
x4 = np.array([8, 8, 8, 8, 8, 8, 8, 19, 8, 8, 8])
y4 = np.array([6.58, 5.76, 7.71, 8.84, 8.47, 7.04, 5.25,12.5, 5.56, 7.91, 6.89])
x0 = np.array([ 10, 8, 13, 9, 11, 14, 6, 4, 12, 7,5, 15, 16, 18 ])
y0 = np.array([ 9.14, 8.14, 8.74,8.77, 9.26, 8.10, 6.13, 3.10, 9.13, 7.26, 4.74, 6.5, 5, 2.9])

# Ğ’Ñ‹Ğ²ĞµĞ´ĞµĞ¼ Ğ³Ñ€Ğ°Ñ„Ğ¸ĞºĞ¸ Ğ²ÑĞµÑ… Ğ½Ğ°Ğ±Ğ¾Ñ€Ğ¾Ğ² Ğ´Ğ»Ñ Ğ²Ğ¸Ğ·ÑƒĞ°Ğ»ÑŒĞ½Ğ¾Ğ³Ğ¾ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ°
_, ax = plt.subplots(2, 3)
show_XY(x, y1, tt='Ğ”Ğ°Ğ½Ğ½Ñ‹Ğµ (x, y1)', splot=ax[0, 0],
        not_label=True, not_legend=True, show_plots=False)      # Ğ”Ğ°Ğ½Ğ½Ñ‹Ğµ (x, y1)
show_XY(x, y2, tt='Ğ”Ğ°Ğ½Ğ½Ñ‹Ğµ (x, y2)', splot=ax[0, 1],
        not_label=True, not_legend=True, show_plots=False)     # Ğ”Ğ°Ğ½Ğ½Ñ‹Ğµ (x, y2)
show_XY(x, y3, tt='Ğ”Ğ°Ğ½Ğ½Ñ‹Ğµ (x, y3)', splot=ax[0, 2],
        not_label=True, not_legend=True, show_plots=False)     # Ğ”Ğ°Ğ½Ğ½Ñ‹Ğµ (x, y3)
show_XY(x4, y4, tt='Ğ”Ğ°Ğ½Ğ½Ñ‹Ğµ (x4, y4)', splot=ax[1, 0],
        not_label=False, not_legend=True, show_plots=False)     # Ğ”Ğ°Ğ½Ğ½Ñ‹Ğµ (x4, y4)
show_XY(x0, y0, tt='Ğ”Ğ°Ğ½Ğ½Ñ‹Ğµ (x0, y0)', splot=ax[1, 1],
        not_label=False, not_legend=True, show_plots=False)     # Ğ”Ğ°Ğ½Ğ½Ñ‹Ğµ (x0, y0)
plt.show()

# Ğ Ğ°ÑÑÑ‡Ğ¸Ñ‚Ğ°ĞµĞ¼ Ñ€ĞµĞ³Ñ€ĞµÑÑĞ¸Ñ Ğ´Ğ»Ñ Ğ¿Ğ¾Ğ´Ñ…Ğ¾Ğ´ÑÑ‰Ğ¸Ñ… Ğ½Ğ°Ğ±Ğ¾Ñ€Ğ¾Ğ² Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… (1-Ğ¹ Ğ¸ 3-Ğ¹)
_, ax = plt.subplots(1, 2)

b_0m, b_1m  = LinRegression_matrix(x, y1)                      # Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼ Ğ¼Ğ°Ñ‚Ñ€Ğ¸Ñ‡Ğ½Ñ‹Ğµ Ğ²Ñ‹Ñ‡Ğ¸ÑĞ»ĞµĞ½Ğ¸Ñ
R = np.corrcoef(x, y1) ** 2                                    # ĞºĞ¾ÑÑ„Ñ„Ğ¸Ñ†Ğ¸ĞµĞ½Ñ‚ Ğ´ĞµÑ‚ĞµÑ€Ğ¼Ğ¸Ğ½Ğ°Ñ†Ğ¸Ğ¸
tit = 'Ğ”Ğ°Ğ½Ğ½Ñ‹Ğµ (x, y1)'
print_result(x, y1, b_0m, b_1m, tt=tit, txt_method='Ğ¼Ğ°Ñ‚Ñ€Ğ¸Ñ‡Ğ½Ñ‹Ğ¹ Ğ¼ĞµÑ‚Ğ¾Ğ´')
print(f'ĞšĞ¾ÑÑ„Ñ„Ğ¸Ñ†Ğ¸ĞµĞ½Ñ‚ Ğ´ĞµÑ‚ĞµÑ€Ğ¼Ğ¸Ğ½Ğ°Ñ†Ğ¸Ğ¸ R = {round(R[0, 1], 4)}')
show_XY(x, y1, tt=tit, y_func=f'{b_0m} + {b_1m} * x', splot=ax[0], show_plots=False)

b_0m, b_1m  = LinRegression_matrix(x, y3)                      # Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼ Ğ¼Ğ°Ñ‚Ñ€Ğ¸Ñ‡Ğ½Ñ‹Ğµ Ğ²Ñ‹Ñ‡Ğ¸ÑĞ»ĞµĞ½Ğ¸Ñ
R = np.corrcoef(x, y3) ** 2                                    # ĞºĞ¾ÑÑ„Ñ„Ğ¸Ñ†Ğ¸ĞµĞ½Ñ‚ Ğ´ĞµÑ‚ĞµÑ€Ğ¼Ğ¸Ğ½Ğ°Ñ†Ğ¸Ğ¸
tit = 'Ğ”Ğ°Ğ½Ğ½Ñ‹Ğµ (x, y3)'
print_result(x, y3, b_0m, b_1m, tt=tit, txt_method='Ğ¼Ğ°Ñ‚Ñ€Ğ¸Ñ‡Ğ½Ñ‹Ğ¹ Ğ¼ĞµÑ‚Ğ¾Ğ´')
print(f'ĞšĞ¾ÑÑ„Ñ„Ğ¸Ñ†Ğ¸ĞµĞ½Ñ‚ Ğ´ĞµÑ‚ĞµÑ€Ğ¼Ğ¸Ğ½Ğ°Ñ†Ğ¸Ğ¸ R = {round(R[0, 1], 4)}')
show_XY(x, y3, tt=tit, y_func=f'{b_0m} + {b_1m} * x', splot=ax[1], show_plots=False)
plt.show()

# Ğ¸ÑĞºĞ»ÑÑ‡Ğ¸Ğ¼ Ğ´Ğ»Ñ 3-Ğ³Ğ¾ Ğ½Ğ°Ğ±Ğ¾Ñ€Ğ° Ğ²Ñ‹Ğ±Ñ€Ğ¾Ñ Ğ¸ Ğ¿Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€Ğ¸Ğ¼, Ñ‡Ñ‚Ğ¾ Ğ²Ñ‹ÑˆĞ»Ğ¾:
x = np.array([10, 8, 9, 11, 14, 6, 4, 12, 7, 5])
y3 = np.array([7.46, 6.77, 7.11, 7.81, 8.84, 6.08, 5.39, 8.15, 6.42, 5.73])
b_0m, b_1m  = LinRegression_matrix(x, y3)                      # Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼ Ğ¼Ğ°Ñ‚Ñ€Ğ¸Ñ‡Ğ½Ñ‹Ğµ Ğ²Ñ‹Ñ‡Ğ¸ÑĞ»ĞµĞ½Ğ¸Ñ
R = np.corrcoef(x, y3) ** 2                                    # ĞºĞ¾ÑÑ„Ñ„Ğ¸Ñ†Ğ¸ĞµĞ½Ñ‚ Ğ´ĞµÑ‚ĞµÑ€Ğ¼Ğ¸Ğ½Ğ°Ñ†Ğ¸Ğ¸
tit = 'Ğ”Ğ°Ğ½Ğ½Ñ‹Ğµ (x, y3)'
print_result(x, y3, b_0m, b_1m, tt=tit, txt_method='Ğ¼Ğ°Ñ‚Ñ€Ğ¸Ñ‡Ğ½Ñ‹Ğ¹ Ğ¼ĞµÑ‚Ğ¾Ğ´')
print(f'ĞšĞ¾ÑÑ„Ñ„Ğ¸Ñ†Ğ¸ĞµĞ½Ñ‚ Ğ´ĞµÑ‚ĞµÑ€Ğ¼Ğ¸Ğ½Ğ°Ñ†Ğ¸Ğ¸ R = {round(R[0, 1], 4)}')
show_XY(x, y3, tt=tit, y_func=f'{b_0m} + {b_1m} * x')


# Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ 1-Ğ³Ğ¾ Ğ½Ğ°Ğ±Ğ¾Ñ€Ğ° Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ½Ğ° Ğ½Ğ¾Ñ€Ğ¼Ğ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ
x = np.array([10, 8, 13, 9, 11, 14, 6, 4, 12, 7, 5])
y1 = np.array([8.04, 6.95, 7.58, 8.81, 8.33, 9.96, 7.24, 4.26, 10.84, 4.82, 5.68 ])
# y3 = np.array([7.46, 6.77, 12.74, 7.11, 7.81, 8.84, 6.08, 5.39, 8.15, 6.42, 5.73])
b_0m, b_1m  = LinRegression_matrix(x, y1)                      # Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼ Ğ¼Ğ°Ñ‚Ñ€Ğ¸Ñ‡Ğ½Ñ‹Ğµ Ğ²Ñ‹Ñ‡Ğ¸ÑĞ»ĞµĞ½Ğ¸Ñ
y1_pred = b_0m + b_1m * x
res = y1 - y1_pred          # Ğ¼Ğ°ÑÑĞ¸Ğ² Ğ¾ÑÑ‚Ğ°Ñ‚ĞºĞ¾Ğ²

shap = stats.shapiro(res)
print()
print(f'Ğ¢ĞµÑÑ‚ Ğ¨Ğ°Ğ¿Ğ¸Ñ€Ğ¾ => {shap}')
show_XY(y1_pred, res, tt='ĞÑÑ‚Ğ°Ñ‚ĞºĞ¸ Ğ¾Ñ‚ Ğ»Ğ¸Ğ½.Ñ€ĞµĞ³Ñ€ĞµÑÑĞ¸Ğ¸')


# ĞĞ½Ğ°Ğ»Ğ¸Ğ· ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğ¹ Ğ·Ğ½Ğ°Ñ‡Ğ¸Ğ¼Ğ¾ÑÑ‚Ğ¸ Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ½Ğ¾Ğ¹ Ğ¼Ğ¾Ğ´ĞµĞ»Ğ¸ Ğ»Ğ¸Ğ½ĞµĞ¹Ğ½Ğ¾Ğ¹ Ñ€ĞµĞ³Ñ€ĞµÑÑĞ¸Ğ¸
# Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼ ĞºÑ€Ğ¸Ñ‚ĞµÑ€Ğ¸Ğ¹ Ğ¤Ğ¸ÑˆĞµÑ€Ğ°:
# 1) Ğ£Ñ€Ğ¾Ğ²ĞµĞ½ÑŒ Ğ·Ğ½Ğ°Ñ‡Ğ¸Ğ¼Ğ¾ÑÑ‚Ğ¸ ĞºÑ€Ğ¸Ñ‚ĞµÑ€Ğ¸Ñ - ÑÑ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚Ğ½Ñ‹Ğ¹ Î± =0,05
# Ğ”Ğ»Ñ ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ñ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ÑÑ Ğ¾Ğ´Ğ½Ğ¾ÑÑ‚Ğ¾Ñ€Ğ¾Ğ½Ğ½Ğ¸Ğ¹ Ñ‚ĞµÑÑ‚, Ğ¿Ñ€Ğ¸ ĞºĞ¾Ñ‚Ğ¾Ñ€Ğ¾Ğ¼
# Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ½Ğ¾Ğµ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ ĞºÑ€Ğ¸Ñ‚ĞµÑ€Ğ¸Ñ Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ¾ Ğ±Ñ‹Ñ‚ÑŒ Ğ±Ğ¾Ğ»ÑŒÑˆĞµ ĞºÑ€Ğ¸Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğ³Ğ¾ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ñ
# Ğ´Ğ»Ñ Ğ²Ñ‹Ğ±Ñ€Ğ°Ğ½Ğ½Ğ¾Ğ³Ğ¾ ÑƒÑ€Ğ¾Ğ²Ğ½Ñ Ğ·Ğ½Ğ°Ñ‡Ğ¸Ğ¼Ğ¾ÑÑ‚Ğ¸ Ğ¸ ÑÑ‚ĞµĞ¿ĞµĞ½ĞµĞ¹ ÑĞ²Ğ¾Ğ±Ğ¾Ğ´Ñ‹ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ¸Ñ€ÑƒĞµĞ¼Ñ‹Ñ… Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ….
# ĞšÑ€Ğ¸Ñ‚ĞµÑ€Ğ¸Ğ¹ Ğ¤Ğ¸ÑˆĞµÑ€Ğ°:
# FÑ€ = MSÑ„ / MSo
# Ğ—Ğ´ĞµÑÑŒ MSÑ„ (Ñ„Ğ°ĞºÑ‚Ğ¸Ñ‡ĞµÑĞºĞ°Ñ ÑÑƒĞ¼Ğ¼Ğ° ĞºĞ²Ğ°Ğ´Ñ€Ğ°Ñ‚Ğ½Ñ‹Ñ… Ğ¾Ñ‚ĞºĞ»Ğ¾Ğ½ĞµĞ½Ğ¸Ğ¹ Ğ½Ğ° 1 ÑÑ‚ĞµĞ¿ĞµĞ½ÑŒ ÑĞ²Ğ¾Ğ±Ğ¾Ğ´Ñ‹) = SSf / df1
# df1 - ÑÑ‚ĞµĞ¿ĞµĞ½ÑŒ ÑĞ²Ğ¾Ğ±Ğ¾Ğ´Ñ‹ Ñ‡Ğ¸ÑĞ»Ğ¸Ñ‚ĞµĞ»Ñ = p - 1, p - Ñ‡Ğ¸ÑĞ»Ğ¾ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ¸Ñ€ÑƒĞµĞ¼Ñ‹Ñ… Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ¾Ğ² (Ğ²Ñ‹Ğ±Ğ¾Ñ€Ğ¾Ğº = 2)
# Ğ—Ğ´ĞµÑÑŒ MSo (Ğ¾ÑÑ‚Ğ°Ñ‚Ğ¾Ñ‡Ğ½Ğ°Ñ ÑÑƒĞ¼Ğ¼Ğ° ĞºĞ²Ğ°Ğ´Ñ€Ğ°Ñ‚Ğ½Ñ‹Ñ… Ğ¾Ñ‚ĞºĞ»Ğ¾Ğ½ĞµĞ½Ğ¸Ğ¹ Ğ½Ğ° 1 ÑÑ‚ĞµĞ¿ĞµĞ½ÑŒ ÑĞ²Ğ¾Ğ±Ğ¾Ğ´Ñ‹) = SSo / df2
# df2 - ÑÑ‚ĞµĞ¿ĞµĞ½ÑŒ ÑĞ²Ğ¾Ğ±Ğ¾Ğ´Ñ‹ Ğ·Ğ½Ğ°Ğ¼ĞµĞ½Ğ°Ñ‚ĞµĞ»Ñ = n - p, p - Ñ‡Ğ¸ÑĞ»Ğ¾ Ğ¿Ğ°Ñ€Ğ½Ñ‹Ñ… Ğ¸Ğ·Ğ¼ĞµÑ€ĞµĞ½Ğ¸Ğ¹ (Ğ´Ğ»Ñ 1-Ğ³Ğ¾ Ğ½Ğ°Ğ±Ğ¾Ñ€Ğ° Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… = 11)

# Ğ’Ñ‹Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ğ¼ Ñ€Ğ°ÑÑ‡ĞµÑ‚ Ğ´Ğ»Ñ 1-Ğ³Ğ¾ Ğ½Ğ°Ğ±Ğ¾Ñ€Ğ°:
alfa = 0.05
y1_pred = b_0m + b_1m * x
SSf = np.sum((y1_pred - np.mean(y1))**2)
SSo = np.sum((y1 - y1_pred)**2)
pp = 2          # 2-Ğ° Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ° ÑƒÑ‡Ğ°ÑÑ‚Ğ²ÑƒÑÑ‚ Ğ² Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğµ
nn = len(x)     # Ñ‡Ğ¸ÑĞ»Ğ¾ Ğ¿Ğ¾Ğ¿Ğ°Ñ€Ğ½Ñ‹Ñ… Ğ¸Ğ·Ğ¼ĞµÑ€ĞµĞ½Ğ¸Ğ¹
df1 = pp - 1
df2 = nn - pp
MSf = SSf / df1
MSo = SSo / df2
Fsh = MSf / MSo
F_lim = stats.f.ppf(1 - alfa, df1, df2)
print()
print(f'-----------------------------\n'
      f'ĞšÑ€Ğ¸Ñ‚ĞµÑ€Ğ¸Ğ¹ Ğ¤Ğ¸ÑˆĞµÑ€Ğ° = {Fsh}\n'
      f'Ğ—Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ Ğ¿Ğ¾ Ğ´Ğ¾Ğ².Ğ¸Ğ½Ñ‚ĞµÑ€Ğ²Ğ°Ğ»Ñƒ = {F_lim}')
txt_con1 = 'ĞœĞ¾Ğ´ĞµĞ»ÑŒ ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ Ğ·Ğ½Ğ°Ñ‡Ğ¸Ğ¼Ğ°'
txt_con2 = 'Ğ—Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚ÑŒ Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ° ÑĞ»ÑƒÑ‡Ğ°Ğ¹Ğ½Ñ‹Ğ¼Ğ¸ Ñ„Ğ°ĞºÑ‚Ğ¾Ñ€Ğ°Ğ¼Ğ¸'
print(txt_con1 if Fsh > F_lim else txt_con2)

